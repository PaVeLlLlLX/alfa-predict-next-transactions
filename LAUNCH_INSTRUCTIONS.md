# üöÄ Alfa-Bank Transaction Prediction: FT-Transformer Solution

–≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç FT-Transformer –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```text
.
‚îú‚îÄ‚îÄ docker-compose.yml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ GPU
‚îú‚îÄ‚îÄ Dockerfile              # –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ (Python 3.11)
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (torch, rtdl, etc.)
‚îú‚îÄ‚îÄ run.sh                  # –°–∫—Ä–∏–ø—Ç –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ src/                    # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (dataset, model, config)
‚îú‚îÄ‚îÄ scripts/                # –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (prepare, train, predict)
‚îú‚îÄ‚îÄ data/                   # –ü–∞–ø–∫–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö (–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
‚îî‚îÄ‚îÄ  artifacts              # –ü–∞–ø–∫–∞ –¥–ª—è –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏, —Å–ª–æ–≤–∞—Ä—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ SVD
```

---

## üõ† –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **OS:** Linux (Ubuntu 20.04+).
2. **GPU:** NVIDIA GPU + –¥—Ä–∞–π–≤–µ—Ä—ã (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ `nvidia-smi`).
3. **Docker:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Docker Engine –∏ Docker Compose.
4. **NVIDIA Container Toolkit:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ GPU.

### –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ NVIDIA Toolkit (–µ—Å–ª–∏ –Ω–µ—Ç)
```bash
sudo apt-get update
sudo apt-get install -y nvidia-container-toolkit
sudo nvidia-ctk runtime configure --runtime=docker
sudo systemctl restart docker
# –ü—Ä–æ–≤–µ—Ä–∫–∞:
docker run --rm --gpus all nvidia/cuda:11.8.0-base-ubuntu22.04 nvidia-smi
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Quick Start)

1. –ü–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö (`train_1.parquet`, `train_1.parquet`), –≤ –ø–∞–ø–∫—É `data/train/`.
2. –ü–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª—ã `test.csv`, `mcc_to_cat_mapping.xlsx` –≤ –ø–∞–ø–∫—É `data/`.
3. –ü–æ–ª–æ–∂–∏—Ç–µ –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ `best_ftt_model.pt` –≤ –ø–∞–ø–∫—É `artifacts`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
chmod +x run.sh
./run.sh
```
1. –í—ã –ø–æ–ø–∞–¥–µ—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ.

---


## üî¨ –ü–∞–π–ø–ª–∞–π–Ω (–ö–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)

–í—ã–ø–æ–ª–Ω—è–π—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏ –≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
python scripts/1_prepare.py
```
–°–æ–∑–¥–∞–µ—Ç: —Å–ø–ª–∏—Ç –¥–∞–Ω–Ω—ã—Ö, SVD-–º–æ–¥–µ–ª—å, —Å–ª–æ–≤–∞—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
python scripts/2_train.py
```
–û–±—É—á–∞–µ—Ç FT-Transformer –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–µ—Å–∞ artifacts/ftt_epoch_{epoch}.pt.

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤
```bash
python scripts/3_optimize.py
```
–ó–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –∏—â–µ—Ç –∏–¥–µ–∞–ª—å–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ Hamming Score.

### 4. –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑
```bash
python scripts/4_predict.py
```
–ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø–æ—Ä–æ–≥–∏ –∫ —Ç–µ—Å—Ç—É –∏ —Å–æ–∑–¥–∞–µ—Ç submission.csv.

---

## üì§ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–°–∞–±–º–∏—Ç–∞)

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ñ–∞–π–ª `submission.csv` –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É `/code` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ß—Ç–æ–±—ã –∑–∞–±—Ä–∞—Ç—å –µ–≥–æ –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—É, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–Ω—É –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥.

### –°–ø–æ—Å–æ–± 1. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Docker Compose 
–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—ã (–Ω–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞):

```bash
# –°–∏–Ω—Ç–∞–∫—Å–∏—Å: docker compose cp <–∏–º—è_—Å–µ—Ä–≤–∏—Å–∞>:<–ø—É—Ç—å_–≤–Ω—É—Ç—Ä–∏> <–ø—É—Ç—å_–∫—É–¥–∞>
docker compose cp alfa-solution:/code/submission.csv ./submission.csv
```
### –°–ø–æ—Å–æ–± 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Volumes

–¢–∞–∫ –∫–∞–∫ –ø–∞–ø–∫–∏ data –∏ artifacts –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –∫ —Ö–æ—Å—Ç—É, –ª—é–±—ã–µ —Ñ–∞–π–ª—ã, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ç—É–¥–∞ —Å–∫—Ä–∏–ø—Ç–∞–º–∏, –ø–æ—è–≤—è—Ç—Å—è —É –≤–∞—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

```bash
artifacts/best_thresholds.json ‚Äî —É–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Ö–æ—Å—Ç–µ.

artifacts/ft_transformer_best.pt ‚Äî —É–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Ö–æ—Å—Ç–µ.
```
–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∞–±–º–∏—Ç –ø–æ—è–≤–ª—è–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∏–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ src/config.py –∏–ª–∏ scripts/4_predict.py –Ω–∞ –ø–∞–ø–∫—É data/.